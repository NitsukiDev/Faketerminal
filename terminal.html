<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fake Termin√°l NFC</title>
<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#111;
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  height:100vh;
  text-align:center;
}
.screen{display:none;flex-direction:column;gap:15px;}
.active{display:flex;}
input, button{
  padding:15px;
  font-size:18px;
  border:none;
  border-radius:8px;
}
button{cursor:pointer;}
.primary{background:#00c851;color:#fff;}
.danger{background:#ff4444;color:#fff;}
.lights{display:flex;justify-content:center;gap:10px;}
.light{
  width:15px;
  height:15px;
  border-radius:50%;
  background:#003300;
}
.activeLight{background:#00ff00;}
#pinScreen input{
  width:200px;
  letter-spacing:8px;
  text-align:center;
  background:#000;
  color:#0f0;
  font-size:28px;
}
#resultIcon{font-size:80px;}
</style>
</head>

<body>

<!-- MENU -->
<div id="menu" class="screen active">
  <h1>üí≥ Fake NFC Termin√°l</h1>
  <input type="number" id="amountInput" placeholder="Zadejte ƒç√°stku (CZK)">
  <label><input type="checkbox" id="pinCheckbox"> Vy≈æadovat PIN</label>
  <label><input type="checkbox" id="rejectCheckbox"> Zam√≠tnout platbu</label>
  <button id="startBtn" class="primary">Spustit termin√°l</button>
</div>

<!-- TERMIN√ÅL -->
<div id="terminal" class="screen">
  <h2 id="amountDisplay"></h2>
  <p id="statusText">P≈ôilo≈æte kartu k telefonu‚Ä¶</p>
  <div class="lights">
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
    <div class="light"></div>
  </div>
</div>

<!-- PIN -->
<div id="pinScreen" class="screen">
  <h2>Zadejte PIN</h2>
  <input id="pinInput" maxlength="4" type="password" inputmode="numeric">
  <button id="confirmPin" class="primary">Potvrdit</button>
  <button id="cancelPin" class="danger">Zru≈°it</button>
</div>

<!-- V√ùSLEDEK -->
<div id="resultScreen" class="screen">
  <div id="resultIcon">‚ùå</div>
  <h2 id="resultText"></h2>
</div>

<script>
let reject = false
let requirePin = false

function sleep(ms){ return new Promise(r => setTimeout(r, ms)) }

const menu = document.getElementById("menu")
const terminal = document.getElementById("terminal")
const pinScreen = document.getElementById("pinScreen")
const resultScreen = document.getElementById("resultScreen")

const startBtn = document.getElementById("startBtn")
const pinCheckbox = document.getElementById("pinCheckbox")
const rejectCheckbox = document.getElementById("rejectCheckbox")
const amountInput = document.getElementById("amountInput")

const lights = document.querySelectorAll(".light")
const statusText = document.getElementById("statusText")
const amountDisplay = document.getElementById("amountDisplay")
const confirmPin = document.getElementById("confirmPin")
const cancelPin = document.getElementById("cancelPin")
const resultIcon = document.getElementById("resultIcon")
const resultText = document.getElementById("resultText")

async function startNFC(){
  try{
    const ndef = new NDEFReader()
    await ndef.scan()
    ndef.onreading = async () => {
      navigator.vibrate(120)
      await processPayment()
    }
  }catch(e){
    statusText.textContent = "NFC chyba"
  }
}

startBtn.onclick = () => {
  if(amountInput.value <= 0) return
  reject = rejectCheckbox.checked
  requirePin = pinCheckbox.checked
  menu.classList.remove("active")
  terminal.classList.add("active")
  amountDisplay.textContent = amountInput.value + " CZK"
  startNFC()
}

async function processPayment(){
  statusText.textContent = "Zpracov√°v√°m‚Ä¶"
  for(let i=0;i<lights.length;i++){
    lights[i].classList.add("activeLight")
    await sleep(250)
  }
  for(let l of lights) l.classList.remove("activeLight")

  if(requirePin){
    showPinScreen()
  }else{
    finishPayment()
  }
}

confirmPin.onclick = () => {
  finishPayment()
}

cancelPin.onclick = () => {
  showResult(false)
}

function finishPayment(){
  statusText.textContent = reject ? "Transakce zam√≠tnuta‚Ä¶" : "P≈ôij√≠m√°m‚Ä¶"
  setTimeout(()=>{
    showResult(!reject)
  },900)
}

function showPinScreen(){
  pinScreen.classList.add("active")
  terminal.classList.remove("active")
}

function showResult(success){
  terminal.classList.remove("active")
  pinScreen.classList.remove("active")
  resultScreen.classList.add("active")
  resultIcon.textContent = success ? "‚úîÔ∏è" : "‚ùå"
  resultText.textContent = success ? "Platba √∫spƒõ≈°n√°" : "Platba zam√≠tnuta"
}
</script>

</body>
</html>